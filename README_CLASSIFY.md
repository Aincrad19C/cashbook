# 交易类型智能分类功能

## 功能说明

在导入账单时，系统会自动识别缺失的交易类型（flowType）和支出/收入类型（industryType）。

## 工作原理

1. **当前策略**：如果用户在字段映射中已经配置了类型字段，直接使用映射的值
2. **智能识别**：对于缺失类型的流水，系统会调用通义千问API进行智能识别
3. **降级策略**：如果API调用失败或未配置API Key，保持原样（使用当前策略），用户可以手动填写

## 配置API Key

### 方式一：环境变量（推荐）

在项目根目录的 `env` 文件中添加：

```bash
DASHSCOPE_API_KEY=sk-your-api-key-here
```

### 方式二：服务器环境变量

在部署时设置环境变量：

```bash
export DASHSCOPE_API_KEY=sk-your-api-key-here
```

## 获取API Key

1. 访问 [阿里云百炼平台](https://bailian.console.aliyun.com/)
2. 登录后进入"API-KEY管理"
3. 创建新的API Key
4. 将API Key配置到环境变量中

## 使用说明

1. 导入CSV/Excel文件
2. 配置字段映射（如果CSV中已有类型字段，直接映射即可）
3. 点击"下一步"解析数据
4. 系统会自动识别缺失类型的流水
5. 在预览页面可以修改识别结果
6. 确认无误后点击"导入数据"

## 识别规则

### 支出类型
- 饮食：餐厅、饭店、美食、餐饮、咖啡、奶茶、外卖、超市、便利店等
- 交通：地铁、公交、打车、滴滴、交通、加油、停车等
- 娱乐：电影、游戏、娱乐、ktv、旅游等
- 购物：购物、商城、淘宝、京东、拼多多等
- 医疗：医院、药店、医疗等
- 教育：教育、培训、课程等
- 住房：房租、房贷、物业等
- 其他：未匹配到以上类型的支出

### 收入类型
- 工资：工资、薪资等
- 奖金：奖金、绩效等
- 投资收益：投资、理财、收益等
- 兼职：兼职、副业等
- 其他：未匹配到以上类型的收入

## 注意事项

1. API调用需要网络连接
2. 如果API Key未配置，系统会静默跳过识别，保持原样
3. 识别结果仅供参考，建议在预览中检查并修改
4. 批量识别会有延迟，避免API限流

